version: "1.0"

build:
  commands:
    - npm install
    - npm run build
    - npm test

environments:
  - name: dev
    region: us-east-1
    account: "123456789012"
    stacks:
      - name: ArchonInfrastructureStack
        path: lib/archon-infrastructure-stack.ts
      - name: ArchonKnowledgeBaseStack
        path: lib/archon-knowledge-base-stack.ts
        dependsOn:
          - ArchonInfrastructureStack
      - name: ArchonAgentStack
        path: lib/archon-agent-stack.ts
        dependsOn:
          - ArchonKnowledgeBaseStack
      - name: ArchonMonitoringDashboard
        path: lib/archon-monitoring-dashboard.ts
        dependsOn:
          - ArchonAgentStack
    tests:
      commands:
        - npm run test:integration
